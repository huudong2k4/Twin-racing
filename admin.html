<!DOCTYPE html><html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quản trị sản phẩm - Twin Racing</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f4f4f4; }
    input, textarea, select { display: block; width: 100%; margin-bottom: 10px; padding: 8px; }
    button { padding: 10px 20px; background: green; color: white; border: none; cursor: pointer; }
    .product { background: white; padding: 10px; margin-bottom: 10px; border-radius: 5px; }
    .product img { max-width: 100px; display: block; }
    .actions button { margin-right: 5px; }
  </style>
</head>
<body>
  <h1>Quản trị sản phẩm - Twin Racing</h1>  <h2>Thêm / Sửa sản phẩm</h2>
  <form id="product-form">
    <input type="hidden" id="product-id">
    <input type="text" id="name" placeholder="Tên sản phẩm" required>
    <input type="number" id="price" placeholder="Giá" required>
    <input type="text" id="image" placeholder="Link ảnh" required>
    <textarea id="description" placeholder="Mô tả" required></textarea>
    <input type="text" id="buyLink" placeholder="Link mua" required>
    <select id="category">
      <option value="oc-titan">Ốc titan</option>
      <option value="phu-kien-inox">Phụ kiện inox</option>
      <option value="khac">Khác</option>
    </select>
    <button type="submit">Lưu sản phẩm</button>
  </form>  <h2>Danh sách sản phẩm</h2>
  <div id="product-list"></div>  <script>
    const firebaseConfig = {
      databaseURL: "https://twinracing-5c171-default-rtdb.asia-southeast1.firebasedatabase.app"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const form = document.getElementById("product-form");
    const list = document.getElementById("product-list");

    form.onsubmit = (e) => {
      e.preventDefault();
      const id = document.getElementById("product-id").value || db.ref().child('products').push().key;
      const data = {
        name: document.getElementById("name").value,
        price: parseInt(document.getElementById("price").value),
        image: document.getElementById("image").value,
        description: document.getElementById("description").value,
        buyLink: document.getElementById("buyLink").value,
        category: document.getElementById("category").value
      };
      db.ref("products/" + id).set(data);
      form.reset();
      document.getElementById("product-id").value = "";
    };

    db.ref("products").on("value", snapshot => {
      list.innerHTML = "";
      snapshot.forEach(child => {
        const p = child.val();
        const div = document.createElement("div");
        div.className = "product";
        div.innerHTML = `
          <strong>${p.name}</strong> - ${p.price}đ<br>
          <img src="${p.image}" alt=""><br>
          <em>${p.description}</em><br>
          <a href="${p.buyLink}" target="_blank">Link mua</a><br>
          <small>Loại: ${p.category}</small><br>
          <div class="actions">
            <button onclick='editProduct("${child.key}", ${JSON.stringify(p)})'>Sửa</button>
            <button onclick='deleteProduct("${child.key}")'>Xoá</button>
          </div>
        `;
        list.appendChild(div);
      });
    });

    function editProduct(id, p) {
      document.getElementById("product-id").value = id;
      document.getElementById("name").value = p.name;
      document.getElementById("price").value = p.price;
      document.getElementById("image").value = p.image;
      document.getElementById("description").value = p.description;
      document.getElementById("buyLink").value = p.buyLink;
      document.getElementById("category").value = p.category;
    }

    function deleteProduct(id) {
      if (confirm("Bạn có chắc muốn xoá sản phẩm này?")) {
        db.ref("products/" + id).remove();
      }
    }
  </script></

  
