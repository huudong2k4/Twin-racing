<!DOCTYPE html><html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Twin Racing</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, doc, deleteDoc, updateDoc } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";const firebaseConfig = {
  apiKey: "AIzaSyC0nt3jsF2TtovgNkx8x0p9iUyyWaDYf8Q",
  authDomain: "twinracing-5c171.firebaseapp.com",
  projectId: "twinracing-5c171",
  storageBucket: "twinracing-5c171.appspot.com",
  messagingSenderId: "935865625166",
  appId: "1:935865625166:web:758b879ec96eecda18b11f",
  measurementId: "G-GBM4MPMB7P"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const sanPhamRef = collection(db, "sanpham");

const form = document.getElementById("form-sanpham");
const danhSach = document.getElementById("danhsach-sanpham");

async function taiDanhSach() {
  danhSach.innerHTML = "";
  const querySnapshot = await getDocs(sanPhamRef);
  querySnapshot.forEach((docItem) => {
    const data = docItem.data();
    const div = document.createElement("div");
    div.innerHTML = `
      <hr>
      <p><strong>${data.ten}</strong> - ${data.loai} - ${data.gia}đ</p>
      <img src="${data.anh}" width="100"><br>
      <p>${data.mota}</p>
      <button onclick="xoaSanPham('${docItem.id}')">Xoá</button>
    `;
    danhSach.appendChild(div);
  });
}

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  const ten = form.ten.value;
  const loai = form.loai.value;
  const anh = form.anh.value || "https://via.placeholder.com/150";
  const gia = parseInt(form.gia.value);
  const linkmua = form.linkmua.value;
  const mota = form.mota.value;

  await addDoc(sanPhamRef, { ten, loai, anh, gia, linkmua, mota });
  form.reset();
  taiDanhSach();
});

window.xoaSanPham = async (id) => {
  await deleteDoc(doc(db, "sanpham", id));
  taiDanhSach();
}

taiDanhSach();

  </script>
</head>
<body>
  <h1>Đăng / Chỉnh sửa sản phẩm</h1>
  <form id="form-sanpham">
    <label>Tên sản phẩm: <input name="ten" required></label><br>
    <label>Loại sản phẩm:
      <select name="loai">
        <option value="Ốc titan">Ốc titan</option>
        <option value="Phụ kiện inox">Phụ kiện inox</option>
      </select>
    </label><br>
    <label>Link ảnh: <input name="anh" placeholder="URL ảnh..."></label><br>
    <label>Giá: <input type="number" name="gia" required></label><br>
    <label>Link mua: <input name="linkmua"></label><br>
    <label>Mô tả: <textarea name="mota"></textarea></label><br>
    <button type="submit">Lưu</button>
  </form>
  <h2>Danh sách sản phẩm</h2>
  <div id="danhsach-sanpham"></div>
</body>
</html>
